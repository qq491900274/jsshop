{include file="public/header"}

<div class="content" id="teacher">
    <div class="rightBox">
        <div class="main">
            <h3>教师列表</h3>
            <div class="topBtns">
                <a href="#">新增教师</a>
                <a href="#">批量上传</a>
                <a href="#">zip模板</a>
            </div>

            <div class="seach_tigs">
                <form id="form1" method="" action="">
                    <ul class="clearfix">
                        <li>
                            <label class="seach-label">
                                教师姓名：
                            </label>
                            <input type="text" name="teacher_name" v-model="subjectList.name"  placeholder="请输入教师姓名" class="form-control">
                        </li>
                        <li>
                            <label class="seach-label">
                                教师编号：
                            </label>
                            <input type="text" name="teacher_number" v-model="code"  placeholder="请输入教师编号" class="form-control">
                        </li>
                        <li>
                            <label class="seach-label">
                                科目：
                            </label>
                            <select class="form-control" name="subject_id">
                                <option value="">请选择</option>
                                <option v-for='subject in subjectList' :value="subject.value">{{subject.label}}</option>
                            </select>
                        </li>
                        <li style="width:32.33%;text-align:left;margin-left:40px;">
                            <label class="seach-label">
                                是否显示：
                            </label>
                            <select class="form-control" name="status" style="width:60%;">
                                <option value="">请选择</option>
                                <option  value="1">显示</option>
                                <option  value="2">隐藏</option>
                            </select>
                        </li>
                        <li style="width:63.66%;margin-left:8px;">
                            <label class="seach-label">
                                所属校区：
                            </label>
                            <select class="form-control input-median" text="true" name="province_id"
                                    id="province_id" selectedindex="2" v-model="province">
                                   
                            </select>
                            <select class="form-control input-median" text="true" name="city_id" id="city_id" v-model="city">
                                
                            </select>
                            <select class="form-control input-median" text="true" name="district_id" id="district_id"   @change="choose()" v-model="area">
                            </select>
                            <select class="form-control input-median" name="school_id" id="school_id">
                                <option value="">请选择校区</option>
                                <option v-for="schoolName in school_name">{{schoolName.SCHOOL_NAME}}</option>
                            </select>
                        </li>
                    </ul>
                    <div class="seach">
                        <input type="button" name="" value="搜索" @click="get();">
                    </div>
                    
                </form>
            </div>

            <table class="tableBox">
                    <thead>
                        <tr>
                            <th>选择</th>
                            <th>教师姓名</th>
                            <th>教师头像</th>
                            <th>编号</th>
                            <th>所属校区</th>
                            <th>科目</th>
                            <th>课程数</th>
                            <th>排序</th>
                            <th>更新时间</th>
                            <th>是否显示</th>
                            <th>操作</th>
                        </tr>
                    </thead>
                    <tbody id="storeList">
                        <tr v-for="product in products">
                            <td><input type="checkbox" name="ids[]" class="check_one" value="658"  /></td>
                            <td>{{product.NAME}}</td>
                            <td><img :src="product.imgUrl" height="60" /></td>
                            <td>{{product.CODE}}</td>
                            <td>{{product.SCHOOL}}</td>
                            <td>{{product.SUBJECT}}</td>
                            <td>{{product.num}}</td>
                            <td>{{product.order}}</td>
                            <td>{{product.DATE}}</td>
                            <td>显示</td>
                            <td>
                            <a href="">编辑</a>
                            </td>
                        </tr>
                                   
                        </tbody>
                </table>
                <div class="topBtns1">
                    <a href="javascript:;" onclick="selectAll()">全选</a>
                    <a href="javascript:;" onclick="uselectAll()">反选</a>
                    <a href="javascript:;" onclick="hideAll()">批量隐藏</a>
                </div>
                <div class="page">
                    <ul class="clearfix pageonload" v-html="html">
                       {{html}}
                    </ul>

                </div>
        </div>
    </div>
</div>

{include file="public/footer"}

<script type="text/javascript">
    /**
     *****搜索*********
    **/
    var baseurl="<?php echo BASE_URL;?>"
    var vue=new Vue({
        el:'#teacher',
        data:{
            name:'',
            code:'',
            page:'',
            subjectList:[
                {value:1,label:'语文'},
                {value:2,label:'数学'},
                {value:3,label:'英语'},
                {value:4,label:'历史'},
                {value:5,label:'地理'},
                {value:6,label:'生物'},
                {value:7,label:'物理'},
                {value:8,label:'化学'}
            ],
            province:'',
            city:'',
            area:'',
            html:'',
            school_name:[],
            count:'',
            page:'1',
            products:[
                
            ]
        },
        methods:{
            get:function(){
                this.$http.post(baseurl+'?s=admin/Lesson/get_teacherval',{
                    'name':this.name,
                    'code':this.code,
                    'subject':this.subjectList,
                    'province':this.province,
                    'city':this.city,
                    'area':this.area,
                    'school_name':this.school_name
                }).then(function(res){
                    console.log(res);
                    this.products=eval('('+res.bodyText+')');
                },function(res){
                    console.log('请求失败处理,请检查Network!');
                })
            },
          choose:function(){
            this.$http.post(baseurl+'?s=admin/Lesson/get_school',{
                'province':this.province,
                'city':this.city,
                'area':this.area}).then(res=>{
                    //console.log(res);
                    this.school_name=eval('('+res.bodyText+')');

                },res=>{
                    console.log('请求失败处理,请检查Network!');
                })
            
          },
          page1:function(val){

                this.$http.post(baseurl+'?s=admin/Lesson/get_teacherval',{page:val}).then(res=>{
                //console.log(res);
                var val=eval('('+res.bodyText+')');
                this.page=val['page'];//当前页面
                //赋值教师列表
                this.products=val['value'];
               
            },res=>{
                console.log('请求失败处理,请检查Network!');
            })
          }
            
        },
        created:function(){
            this.$http.post(baseurl+'?s=admin/Lesson/get_teacherval').then(res=>{
                //console.log(res);
                var val=eval('('+res.bodyText+')');
                //赋值教师列表
                this.products=val['value'];
                //获取总共多少页面
                this.count=val['count'];
                //处理总共多少页
                var html='<li><a href="javascript:void(0)" onclick="page1(\'prev\');">上一页</a></li>';
                for(i=0; i<this.count; i++ ){
                    if(i < 8){
                        if (i=='0') {
                            html+='<li class="curr"><a href="javascript:void(0)" onclick="page1(\''+(i+1)+'\');">'+(i+1)+'</a></li>';
                        }else{
                            html+='<li><a href="javascript:void(0)" onclick="page1(\''+(i+1)+'\');">'+(i+1)+'</a></li>';
                        }
                        
                    }
                }
                if(this.count > 7){
                    html+="<li><a href='javascript:void(0)' >...</a></li>";
                }
                html+="<li><a href='javascript:void(0)' onclick='page1(\"next\")';>下一页</a></li>";
                this.html=html;

            },res=>{
                console.log('请求失败处理,请检查Network!');
            })
            
        },

          

    })
    function page1(data){
        //从vue获取当前页
        var page=vue.page;
        //判断是否是超过总页数
        if (data=='next') {
            data=parseInt(vue.page)+1;
        }else if(data=='prev'){
            data=vue.page-1;
        }
        //判断是否是超过总页数，是否小于0页
        if (data > vue.count || data <= '0') {
            return;
        }

        //调用vue
        vue.page1(data);
        //添加高亮样式
        $('.curr').attr('class',' ');
        $('.pageonload > li').eq(data).attr('class','curr');
    }  


/****************点击事件***************************/
 // showLocation();
 //    CheckProvince('');
 //    CheckCity('');
 //    CheckTown('');
     /**
     *****批量隐藏*********
    **/
   function hideAll(){
            if($('.check_one:checked').length < 1){
                layer.msg('您还未勾选任何项');
                return false;
            }
            layer.confirm('确定要批量隐藏选中的项吗?',function(){
                var ids = [];
                $('.check_one:checked').each(function(){
                    ids.push($(this).val());
                });
                ids = ids.join(',');

                //var url ="<?php echo BASE_URL;?>";
                $.post(baseurl+'?s=admin/Lesson/dele_teacher',{'id':ids},function(data){
                    if(data == 1){
                        layer.msg(data.info);
                    }else{
                        location.reload();
                    }
                },'JSON');
            });
        }





</script>
<script type="text/javascript">
    var isChrome = window.navigator.userAgent.indexOf("Chrome") !== -1;
(function() {
    if (!isChrome) {
        $("#is_chrome").html("为了更好的使用效果请使用Chrome浏览器");
    }
})();
</script>
</body>
</html>