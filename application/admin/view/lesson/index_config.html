{include file="public/header"}

<div class="content index_config" id="indexConfig">
	<div class="main">
		<div class="indexLi">
			<h3>banner幻灯片</h3>
			<div class='indexBox'>
				<ul v-for="(v,index) in bannerLis">
					<li>
						<span>轮播图片：</span>
						<input type="text" name="" class="inputOne em" v-model="v.imgUrl" id="hpic"> 
						<div><p class="on" onclick="file(this,'bannerLis')">上传</p></div>
					</li>
					<li>
						<span>轮播链接：</span>
						<input type="text" name="" class="inputOne" v-model="v.imgHref">
					</li>
					<li>
						<span>轮播排序：</span>
						<input type="text" name="" class="inputOne" v-model="v.num">
						<div><p class="on remove" @click="remove(v.ID,index);">删除</p></div>
					</li>
				</ul>
			</div>
			<a href="javascript:void(0)" class="add on" @click="addList()">添加轮播图</a>
		</div>
		<div class="indexLi">
			<h3><input type="text" name="" value="学习性格测试"></h3>
			<div class='indexBox'>
				<ul v-for="v in imgLis">
					<li>
						<span>轮播图片：</span>
						<input type="text" name="" class="inputOne em" v-model="v.imgUrl">
						<div><p class="on" onclick="file(this,'imgLis')">上传</p></div>
					</li>
					<li>
						<span>轮播链接：</span>
						<input type="text" name="" class="inputOne" v-model="v.imgHref">
					</li>
					<li>
						<span>轮播排序：</span>
						<input type="text" name="" class="inputOne" v-model="v.num">
						<div><p class="on remove" @click="remove();">删除</p></div>
					</li>
				</ul>
			</div>
			<a href="javascript:void(0)" class="add on" @click="addImgList()">添加轮播图</a>
		</div>
		<div class="indexLi">
			<h3><input type="text" name="" value="热门活动"></h3>
			<div class='indexBox'>
				<ul v-for="v in hotLis">
					<li>
						<span>轮播图片：</span>
						<input type="text" name="" class="inputOne em" v-model="v.imgUrl">
						<div><p class="on" onclick="file(this,'hotLis')">上传</p></div>
					</li>
					<li>
						<span>轮播链接：</span>
						<input type="text" name="" class="inputOne" v-model="v.imgHref">
					</li>
					<li>
						<span>轮播排序：</span>
						<input type="text" name="" class="inputOne" v-model="v.num">
						<div><p class="on remove" @click="remove();">删除</p></div>
					</li>
				</ul>
			</div>
			<a href="javascript:void(0)" class="add on" @click="addHotList()">添加轮播图</a>
		</div>
		<div class="indexLi">
			<h3>碎片管理</h3>
			<ul>
				<li>
					<span>金石教育热线：</span>
					<input type="text" name="" class="inputOne" v-model="hotPhone">
				</li>
				<li>
					<span>小学拼客专线：</span>
					<input type="text" name="" class="inputOne" v-model="majorPhone">
				</li>
			</ul>
			<!-- <a href="javascript:void(0)" class="on" class="add">添加碎片</a>-->
		</div>
		<div class="seach" style="margin-top: 20px;margin-left: 2%;"><input type="submit" name="" value="确认" @click="get()"></div> 
	</div>
</div>


{include file="public/footer"}
<script type="text/javascript">
	function getsrc(src){

		var key=vue.picname;
		var index=vue.picindex;
		if (key=='bannerLis') {
			vue.bannerLis[index].imgUrl=src;
		}else if(key=='imgLis'){
			vue.imgLis[index].imgUrl=src;
		}else if(key=='hotLis'){
			vue.hotLis[index].imgUrl=src;
		}
		
	}
	/*******点击上传获取文件路径***********/
	function file(this0,str){
		vue.picindex=$(this0).parents('ul').index();
		vue.picname=str;
		layer.open({
		  type: 2,
		  title: '上传图片',
		  shadeClose: true,
		  shade: 0.8,
		  area: ['400px', '200px'],
		  content: baseurl+'?s=admin/uploadpic/config_pic' //iframe的url
		});
		var index = parent.layer.getFrameIndex(window.name); //获取窗口索引
		console.log(index);
		//parent.layer.close(index);
	}

	/*************添加轮播图*******************/
	var vue=new Vue({
    el:'#indexConfig',
	    data:{
	    	bannerLis:[
	    		{imgUrl:'',imgHref:'',num:''}
	    	],
	    	imgLis:[
	    		{imgUrl:'',imgHref:'',num:''}
	    	],
	    	hotLis:[
	    		{imgUrl:'',imgHref:'',num:''}
	    	],
	    	hotPhone:'',
	    	majorPhone:'',
	    	picindex:'',
	    	picname:''
	    },
	    methods:{
	        get:function(){
	        	this.$http.post(baseurl+'?s=admin/Lesson/index_config',{
	        		'bannerLis':this.bannerLis,
	        		'imgLis':this.imgLis,
	        		'hotLis':this.hotLis,
	        		'hotPhone':this.hotPhone,
	        		'majorPhone':this.majorPhone
	        	}).then(res=>{
	        		var val=eval('('+res.bodyText+')');
	        	},res=>{
	        		console.log('请求失败，请检查Network！');
	        	})
	        },
	        remove:function(ids,arrid){
	        	layer.alert('确定要删除吗？',function(){
	        		vue.$http.post(baseurl+'',{id:ids}).then(res=>{
	        			var num=eval('('+res.bodyText+')');
	        			if(num==1){
	        				layer.msg('删除成功！',{time:1500});
	        				vue.bannerLis.splice(arrid,1);
	        			}else{
	        				location.reload();
	        			}
	        		},res=>{
	        			console.log('请求失败，请检查Network！');
	        		})
	        	})
	        },

	        addList:function(){
	        	this.bannerLis.push({imgUrl:'',imgHref:'',num:''});
	        },
	        addImgList:function(){
	        	this.imgLis.push({imgUrl:'',imgHref:'',num:''});
	        },
	        addHotList:function(){ 
	        	this.hotLis.push({imgUrl:'',imgHref:'',num:''});
	        }
	    }
	})
</script>

</body>
</html>