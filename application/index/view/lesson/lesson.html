{include file="common/header"}

<body>
<div id="lessonList">
<div class="tab">
	<div class="main2">
		<ul>
			<li v-for="v in type" @click="typeLe(v.ID)"><a href="#">{{v.NAME}}<span class="block"><i class="icon iconfont">&#xe65b;</i></span></a></li>
		
		</ul>
	</div>
</div>
<div class="lessonLi">
  <div class="main4">
	<ul>
		<li v-for="v in listBox"><a href="javascript:void(0)" @click="show(v.ID)">
			<h3>{{v.NAME}}({{v.SEASONTYPE}})</h3>
			<p>以教学大纲为主线</p>
			<p>综合梳理重要知识，构建系统学科框架</p>
      <p class="time">{{v.STARTTIME}} 至 {{v.ENDTIME}}</p>
      <div class="bot clearfix">
        <div><img src="__PUBLIC__/index/images/sp_05.png"><span>许向前</span></div>
        <h1><span>￥</span>{{v.PRICE}}</h1>
      </div>  
		</a></li>
	</ul>
  </div>
</div>

<!-- <div class="search"><i class="icon iconfont">&#xe614;</i></div> -->

<div id="sideNav">
      <div class="wrapper clearfix">
        <nav id="main-nav">
          <ul class="second-nav">
            <li v-for="(v,index) in products">
              <a href="#">{{v.NAME}}</a>

              <ul>
              	<li v-for="t in products[index].SUBJECTID" onclick="grade(this)">
                  <a href="#">{{t.NAME}}</a>
                  <input type="hidden" name="" :value="v.ID" class="vid">
                  <input type="hidden" name="" :value="t.ID" class="tid">
                </li>
              </ul>
            </li>
          </ul>
        </nav>
        <a class="toggle"><img src="__PUBLIC__/index/images/less_02.png" @click="get()"></a>
      </div>
</div>
<!--< div class="lessSearch"><i class="icon iconfont">&#xe614;</i></div> -->
</div>


<script>
  var school=getcookie('school');
  var gradeId;
  var subjectId;
  var typeId;

function grade(list){
  vid=$(list).find('.vid').val();
  tid=$(list).find('.tid').val();
  gradeId=vid;
  subjectId=tid;
  vue.grade();
}
 
var vue=new Vue({
  el:'#lessonList',
  data:{
    products:[],
    type:[],
    listBox:[]
  },
  methods:{
    goupdate:function(id){
      window.location.href=baseurl+'?s=admin/Lesson/get_lesson&id='+id;
    },
    grade:function(){
      this.$http.post(baseurl+'?s=index/Lesson/get_class',{'class':gradeId,'subject':subjectId,'school':school,'classtypeguid':typeId}).then(res=>{
        this.listBox=eval('('+res.bodyText+')');
      },res=>{
        console.log('请求失败,请检查Network!');
      })
    },
    typeLe:function(vid){
      typeId=vid;
      this.$http.post(baseurl+'?s=index/Lesson/get_class',{'classtypeguid':typeId,'school':school,'class':gradeId,'subject':subjectId}).then(res=>{
        this.listBox=eval('('+res.bodyText+')');
      },res=>{
        console.log('请求失败,请检查Network!');
      })
    },
    get:function(){
        $(function(){
          var $nav = $('#main-nav');
          var $toggle = $('.toggle');
          var defaultData = {
            maxWidth: false,
            customToggle: $toggle,
            navTitle: '金石教育',
            levelTitles: true
          };
          // we'll store our temp stuff here
          var $clone = null;
          var data = {};
          // calling like this only for demo purposes
          const initNav = function(conf) {
            if ($clone) {
              // clear previous instance
              $clone.remove();
            }
            // remove old toggle click event
            $toggle.off('click');
            // make new copy
            $clone = $nav.clone();
            // remember data
            $.extend(data, conf);
            // call the plugin
            $clone.hcMobileNav($.extend({}, defaultData, data));
          }
          // run first demo
          initNav({});
          $('.actions').find('a').on('click', function(e) {
            e.preventDefault();
            var $this = $(this).addClass('active');
            var $siblings = $this.parent().siblings().children('a').removeClass('active');
            initNav(eval('(' + $this.data('demo') + ')'));
          });
        });
    }
  },
  created:function(){
    this.$http.post(baseurl+'?s=index/Lesson/index',{list:1}).then(res=>{
      this.products=eval('('+res.bodyText+')')['value'];
    },res=>{
       console.log('请求失败,请检查Network!');
    });
    this.$http.post(baseurl+'?s=admin/Lesson/type',{list:1}).then(res=>{
      this.type=eval('('+res.bodyText+')')['value'];
    },res=>{
      console.log('请求失败,请检查Network!');
    });

  }
})
</script>

{include file="common/footer"}
<script type="text/javascript" src="__PUBLIC__/index/js/hc-mobile-nav.js"></script>

</body>
</html>